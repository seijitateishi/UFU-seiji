<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal Veículo Já!</title>
    <link rel="stylesheet" href="../../styles.css" />
</head>

<body>
    <header>
        <div class="header-content">
            <div class="logo">
                <img src="../../images/logo.png" alt="Logotipo" />
                <h1>Veículo Já!</h1>
            </div>
            <nav>
                <ul>
                    <li><a href="#">Home</a></li>
                    <li><a href="views/public/cadastro.html">Cadastro</a></li>
                    <li><a href="views/public/login.html">Login</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <section class="search-panel">
            <form>
                <div class="select-group">
                    <label for="marca">Marca:</label>
                    <select id="marca" name="marca">
                        <option value="">Selecione</option>
                        <option value="fiat">Fiat</option>
                        <option value="chevrolet">Chevrolet</option>
                        <option value="ford">Ford</option>
                    </select>
                </div>
                <div class="select-group">
                    <label for="modelo">Modelo:</label>
                    <select id="modelo" name="modelo">
                        <option value="">Selecione</option>
                        <option value="uno">Uno</option>
                        <option value="corsa">Corsa</option>
                        <option value="focus">Focus</option>
                    </select>
                </div>
                <div class="select-group">
                    <label for="cidade">Cidade:</label>
                    <select id="cidade" name="cidade">
                        <option value="">Selecione</option>
                        <option value="sao_paulo">São Paulo</option>
                        <option value="rio_de_janeiro">Rio de Janeiro</option>
                        <option value="belo_horizonte">Belo Horizonte</option>
                    </select>
                </div>
                <div class="search-button">
                    <button>Buscar</button>
                </div>

            </form>
        </section>

        <section class="cards-container" id="cards-container">
            <!-- Os cards serão inseridos dinamicamente aqui -->
        </section>
        
        <template id="card-template">
            <article class="card">
                <img src="" alt="Imagem do veículo">
                <div class="card-content">
                    <h2></h2>
                    <p class="ano"></p>
                    <p class="cidade"></p>
                    <p class="valor"></p>
                </div>
                <div class="card-buttons">
                    <a href="views/public/registrar_interesse.html">Manifestar interesse</a>
                </div>
            </article>
        </template>
    </main>

    <footer>
        <p>&copy; 2025 Portal Veículo Já! Todos os direitos reservados.</p>
    </footer>

    <script>
        document.addEventListener("DOMContentLoaded", async function () {
            const container = document.getElementById("cards-container");
            const template = document.getElementById("card-template");
    
            try {
                const resposta = await fetch("controladorPublico.php?acao='listarAnuncios'");
                if (!resposta.ok) {
                    throw new Error("Erro ao buscar anúncios: " + resposta.status);
                }
    
                const anuncios = await resposta.json();
                console.log("Anúncios carregados:", anuncios);
    
                anuncios.forEach(anuncio => {
                    const clone = template.content.cloneNode(true);
                    const img = clone.querySelector("img");
                    const titulo = clone.querySelector("h2");
                    const ano = clone.querySelector(".ano");
                    const cidade = clone.querySelector(".cidade");
                    const valor = clone.querySelector(".valor");
    
                    img.src = anuncio.urlImagem || "images/placeholder.png";
                    img.alt = `${anuncio.modelo} ${anuncio.ano}`;
                    titulo.textContent = anuncio.modelo;
                    ano.textContent = `Ano: ${anuncio.ano}`;
                    cidade.textContent = `Cidade: ${anuncio.cidade}`;
                    valor.textContent = `Valor: R$ ${Number(anuncio.preco).toLocaleString("pt-BR")}`;
    
                    container.appendChild(clone);
                });
    
            } catch (erro) {
                console.error("Erro ao carregar anúncios:", erro);
            }
        });
    </script>
</body>

</html>